<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="jw">

				 <!-- ************************ 스케줄 화면 ***************************** -->
				 
    <!-- 한 가게의 예약 리스트 정보 조회 -->
    <select id="selectReserveList" parameterType="int" resultType="com.javaex.vo.ReserveVo">
		SELECT r.*, d.*, p.*, b.*, rt.rtDate, rt.rtTime
		FROM reserve r
		JOIN dog d ON r.dogNo = d.dogNo
		JOIN rsPrice rp ON r.rsNo = rp.rsNo
		JOIN price p ON rp.priceNo = p.priceNo
		JOIN beautylist b ON p.beautyNo = b.beautyNo
		JOIN reserveTime rt ON r.rtNo = rt.rtNo
		WHERE r.bNo = #{bNo};
    </select>
    
    <!-- 일자 수정 -->
    <update id="updateReserveDate" parameterType="com.javaex.vo.ReserveVo">
		UPDATE reserveTime
		SET rtDate = #{rtDate},
		    rtTime = #{rtTime}
		WHERE rtNo = (SELECT rtNo 
		              FROM reserve 
		              WHERE rsNo =#{rsNo});
    </update>
    
    
    <!-- 시간 수정 -->
    <update id="updateReserveTime" parameterType="com.javaex.vo.ReserveVo">
		UPDATE reserveTime
		SET rtTime = #{rtTime}
		WHERE rtNo = (SELECT rtNo 
		              FROM reserve 
		              WHERE rsNo = #{rsNo});
    </update>

    <!-- 예약 삭제 -->
    <delete id="deleteReserve" parameterType="int">
        DELETE FROM reserve
        WHERE rsNo = #{rsNo}
    </delete>
    
    
    
				 <!-- ************************ 알림장 화면 ***************************** -->
  
    <!-- 예약 정보 업데이트 -->
		<update id="updateReserve" parameterType="com.javaex.vo.ReserveVo">
		    UPDATE reserve
		    SET attitude = #{attitude},
		        rCondition = #{rCondition},
		        tangle = #{tangle},
		        disliked = #{disliked},
		        bath = #{bath},
		        message = #{message},
		        curruntWeight = #{curruntWeight}
		    WHERE rtNo = (
		        SELECT rtNo 
		        FROM reserve 
		        WHERE rsNo = #{rsNo}
		    );
		</update>

</mapper>